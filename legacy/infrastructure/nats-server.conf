# NATS Server Configuration for Home Automation (Production Mode)
# This configuration is for local production without Synadia Cloud

# Server name and listen port
server_name: "home-automation-prod"
port: 4222

# HTTP monitoring
http_port: 8222

# Authorization for local connections
authorization {
  # Define users for local home automation services
  users = [
    {
      user: "home"
      password: "changeme"
      permissions: {
        publish: {
          allow: ["home.>", "_INBOX.>", "$JS.>", "$KV.>"]
        }
        subscribe: {
          allow: ["home.>", "_INBOX.>", "$JS.>", "$KV.>"]
        }
      }
    },
    {
      user: "admin"
      password: "admin"
      permissions: {
        publish: ">"
        subscribe: ">"
      }
    }
  ]
}

# JetStream configuration
jetstream {
  # Enable JetStream
  enabled: true
  
  # Directory for JetStream storage
  store_dir: "/data/jetstream"
  
  # Memory and file storage limits
  max_memory_store: 256MB
  max_file_store: 1GB
  
  # Domain for JetStream
  domain: "home"
}

# Logging configuration
debug: false
trace: false
logtime: true

# Limits
max_connections: 1024
max_control_line: 4096
max_payload: 1MB
max_pending: 64MB

# Ping intervals
ping_interval: "2m"
ping_max: 2

# Write deadline
write_deadline: "10s"