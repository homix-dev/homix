# NATS Server Configuration for Home Automation

# Server name and listen port
server_name: "home-automation-local"
port: 4222

# HTTP monitoring
http_port: 8222

# Authorization for local connections
authorization {
  # Define a user for local home automation services
  users = [
    {
      user: "home"
      password: "changeme"
      permissions: {
        publish: {
          allow: ["home.>", "_INBOX.>"]
        }
        subscribe: {
          allow: ["home.>", "_INBOX.>"]
        }
      }
    }
  ]
}

# JetStream configuration
jetstream {
  # Enable JetStream
  enabled: true
  
  # Directory for JetStream storage
  store_dir: "/data/jetstream"
  
  # Memory and file storage limits
  max_memory_store: 256MB
  max_file_store: 1GB
}

# Cluster configuration (optional, for future expansion)
cluster {
  name: "home-automation-cluster"
  listen: 0.0.0.0:6222
  
  # Routes to other servers (add as needed)
  routes = []
}

# Leaf node configuration to connect to Synadia Cloud
# This allows bridging between local and cloud NATS
leafnodes {
  remotes = [
    {
      # URL from your Synadia Cloud cluster
      url: "tls://connect.ngs.global"
      
      # Path to your credentials file
      credentials: "/etc/nats/nats-home-automation.creds"
      
      # Account to use for the leaf connection
      # This allows selective sharing of subjects
      # account: "home-automation"
    }
  ]
}

# Logging configuration
debug: false
trace: false
logtime: true
log_file: "/data/nats-server.log"

# Limits
max_connections: 1024
max_control_line: 4096
max_payload: 1MB
max_pending: 64MB

# Ping intervals
ping_interval: "2m"
ping_max: 2

# Write deadline
write_deadline: "10s"